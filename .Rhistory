model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+
civil_status + type_dwelling+urban_type+religious_participation+long_disease+oplcat_2020,
data = model_est, family = "binomial")
summary(model)
summary(model)
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg+oplcat_2020)^2+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+
civil_status + type_dwelling+urban_type+religious_participation+long_disease,
data = model_est, family = "binomial")
summary(model)
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+mig_by_generation+oplcat_2020+
having_children_future+years_next_children+desired_nr_add_children+
(civil_status + type_dwelling)^2+urban_type+religious_participation+long_disease,
data = model_est, family = "binomial")
summary(model)
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+mig_by_generation+oplcat_2020+
having_children_future+years_next_children+desired_nr_add_children+
(civil_status + religious_participation)^2+urban_type+religious_participation+long_disease,
data = model_est, family = "binomial")
summary(model)
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+oplcat_2020+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + mig_by_generation)^2+urban_type+religious_participation+long_disease,
data = model_est, family = "binomial")
summary(model)
aantalki
data_red$aantalki
table(data_red$aantalki)
data_red$aantalki[data_red$aantalki>2]
data_red$aantalki[data_red$aantalki>2]<-"3+"
data_red$aantalki
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki")]
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type+religious_participation+long_disease,
data = model_est, family = "binomial")
model_df <- merge(data_red, out, by = "nomem_encr")
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki")]
model_est<-model_est[complete.cases(model_est),]
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type+religious_participation+long_disease,
data = model_est, family = "binomial")
summary(model)
plot(model)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety","presence_debt")]
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+oplcat_2020+mig_by_generation+presence_debt
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
model_est<-model_est[complete.cases(model_est),]
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+oplcat_2020+mig_by_generation+presence_debt+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type+religious_participation+long_disease+anxiety,
data = model_est, family = "binomial")
data_red$cp20l019
data_red$cp20l010
data_red$presence_debt
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety")]
model_est<-model_est[complete.cases(model_est),]
model <- spikeSlabGAM(new_child ~(partner_2020+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type+religious_participation+long_disease+anxiety,
data = model_est, family = "binomial")
summary(model)
model <- spikeSlabGAM(new_child ~(religious_participation+birthyear_bg)^2+oplcat_2020+mig_by_generation+partner_2020+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type+long_disease+anxiety,
data = model_est, family = "binomial")
summary(model)
plot(model)
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+partner_2020+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type+long_disease+anxiety,
data = model_est, family = "binomial")
summary(model)
plot(model)
data_red$urban_type2<-data_red$urban_type
data_red$urban_type2
data_red$urban_type2[data_red$urban_type2!="Not urban"]
data_red$urban_type2[data_red$urban_type2!="Not urban"]<-"Urban"
data_red$urban_type2<-as.character(data_red$urban_type)
data_red$urban_type2[data_red$urban_type2!="Not urban"]<-"Urban"
data_red$urban_type2
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety","log_net_household_income")]
model_est<-model_est[complete.cases(model_est),]
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+partner_2020+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety,
data = model_est, family = "binomial")
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety","log_net_household_income")]
model_est<-model_est[complete.cases(model_est),]
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+partner_2020+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety+log_net_household_income,
data = model_est, family = "binomial")
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety","log_net_household_income")]
model_est<-model_est[complete.cases(model_est),]
model_df <- merge(data_red, out, by = "nomem_encr")
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety","log_net_household_income")]
model_est<-model_est[complete.cases(model_est),]
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+partner_2020+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety+log_net_household_income,
data = model_est, family = "binomial")
summary(model)
summary(model)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety")]
model_est<-model_est[complete.cases(model_est),]
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+partner_2020+
having_children_future+years_next_children+desired_nr_add_children+type_dwelling+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety,
data = model_est, family = "binomial")
summary(model)
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling)^2,
data = model_est, family = "binomial")
summary(model)
summary(model)
str(model$mcmc)
model$samples$beta
plot(model$samples$beta)
plot(model$samples$beta)
plot(model$samples$beta)
?spikeSlabGAM
mcmc <- list(nChains = 3, burnin = 1000, chainLength = 4000,
thin = 3, reduceRet = TRUE)
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling),
data = model_est, family = "binomial", mcmc = mcmc)
plot(model$samples$beta)
summary(model)
plot(model)
model$fitted
model$fitted[,2]
plot(model$fitted[,2])
plot(model$fitted[,2])
plot(model$fitted[,2])
boxplot(model$fitted[,2]model_est$new_child)
boxplot(model$fitted[,2]~model_est$new_child)
library(ROCit)
obj <- rocit(class = model_est$new_child, score = model$fitted[,2])
plot(obj)
summary(obj)
model <- readRDS("~/GitHub/fertility-prediction-challenge/model.rds")
obj <- rocit(class = model$y, score = model$fitted.values)
model$fitted.values
model <- readRDS("~/GitHub/fertility-prediction-challenge/model.rds")
model
model$y
ksplot(obj)
obj$neg_D
table(model$y, ifelse(model$fitted.values>0.25,1,0))
table(model$y, ifelse(model$fitted[,2]>0.25,1,0))
table(model$y, ifelse(model$fitted[,2]>0.15,1,0))
table(model$y, ifelse(model$fitted[,2]>0.2,1,0))
obj <- rocit(class = model_est$new_child, score = model$fitted[,2])
plot(obj)
model$fitted[,2]
model_est$new_child
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+birthyear_bg+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling),
data = model_est, family = "binomial", mcmc = mcmc)
obj <- rocit(class = model_est$new_child, score = model$fitted[,2])
plot(obj)
class <- model_est$new_child
score <- model$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
table(model$y, ifelse(model$fitted[,2]>0.2,1,0))
table(model$y, ifelse(model$fitted[,2]>0.4,1,0))
table(model$y, ifelse(model$fitted[,2]>0.45,1,0))
measure
measure$Cutoff[which.max(measure$ACC)]
table(model$y, ifelse(model$fitted[,2]>0.4711597,1,0))
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+(gender_bg+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling),
data = model_est, family = "binomial", mcmc = mcmc)
summary(model)
class <- model_est$new_child
score <- model$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
measure$Cutoff[which.max(measure$ACC)]
max(measure$ACC)
plot(model)
summary(model)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
install.packages("BoomSpikeSlab")
model2 <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+(gender_bg+birthyear_bg)^2+oplcat_2020+mig_by_generation+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling),
data = model_est, family = "binomial", mcmc = mcmc)
summary(model)
summary(model2)
summary(model2)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
measure$Cutoff[which.max(measure$ACC)]
max(measure$ACC)
plot(model2)
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+(gender_bg+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+employment_status+
(civil_status + aantalki)+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling),
data = model_est, family = "binomial", mcmc = mcmc)
summary(model)
class <- model_est$new_child
score <- model$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
measure$Cutoff[which.max(measure$ACC)]
max(measure$ACC)
model2 <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)+(gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling),
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
plot(model$samples$beta)
boxplot(model$fitted[,2]~model_est$new_child)
library(ROCit)
obj <- rocit(class = model_est$new_child, score = model$fitted[,2])
plot(obj)
summary(obj)
ksplot(obj)
obj$neg_D
table(model$y, ifelse(model$fitted[,2]>0.4711597,1,0))
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
max(measure$ACC)
model2 <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)+(partner_2020+gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling)^2,
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
plot(model2)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
max(measure$ACC)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
summary(model2)
model2 <- spikeSlabGAM(new_child ~(religious_participation)+(partner_2020+gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki+religious_participation)^2+long_disease+anxiety+(urban_type2+type_dwelling),
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
plot(model2)
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki+religious_participation)^2+long_disease+anxiety+(urban_type2+type_dwelling)^2,
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","aantalki", "anxiety","cp20l010")]
model_est<-model_est[complete.cases(model_est),]
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+long_disease+anxiety+(urban_type2+type_dwelling)+cp20l010,
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
plot(model2)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
max(measure$ACC)
data_red$cr20m089
table(data_red$cr20m089)
table(data_red$cs20m063)
table(data_red$cs20m283)
table(data_red$cs20m285)
table(data_red$cs20m286)
table(data_red$cs20m287)
data_red$rely <- factor(data_red$cs20m286)
table(data_red$cs20m001)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","rely", "anxiety")]
data_red$rely <- factor(data_red$cs20m286)
model_df <- merge(data_red, out, by = "nomem_encr")
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","rely", "anxiety")]
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+(gender_bg+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+employment_status+
(civil_status + aantalki)+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","rely", "anxiety")]
model_est<-model_est[complete.cases(model_est),]
mcmc <- list(nChains = 3, burnin = 1000, chainLength = 4000,
thin = 3, reduceRet = TRUE)
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+long_disease+anxiety+(urban_type2+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc)
names(model_est)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","rely", "anxiety","model_est")]
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","rely", "anxiety","aantalki")]
model_est<-model_est[complete.cases(model_est),]
mcmc <- list(nChains = 3, burnin = 1000, chainLength = 4000,
thin = 3, reduceRet = TRUE)
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+(gender_bg+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+employment_status+
(civil_status + aantalki)+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc)
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+long_disease+anxiety+(urban_type2+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","rely", "anxiety","aantalki","log_net_household_income")]
model_est<-model_est[complete.cases(model_est),]
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
measure$Cutoff[which.max(measure$ACC)]
max(measure$ACC)
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+long_disease+anxiety+(urban_type2+type_dwelling)+rely+log_net_household_income,
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
max(measure$ACC)
plot(model2)
model_est <- model_df[, c("new_child","having_children_future","years_next_children",
"desired_nr_add_children","birthyear_bg","partner_2020","gender_bg",
"urban_type2", "civil_status","religious_participation",
"employment_status", "type_dwelling","mig_by_generation", "long_disease",
"oplcat_2020","rely", "anxiety","aantalki")]
model_est<-model_est[complete.cases(model_est),]
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)^2+long_disease+anxiety+(urban_type2+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
summary(model2)
plot(model2)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
max(measure$ACC)
plot(model2$samples$beta)
plot(model2$samples$beta)
plot(model2$samples$gamma)
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)+long_disease+anxiety+(urban_type2+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc)
summary(model2)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
measure$Cutoff[which.max(measure$ACC)]
max(measure$ACC)
plot(model2)
plot(model2$samples$beta)
model <- spikeSlabGAM(new_child ~(religious_participation+mig_by_generation)^2+(gender_bg+birthyear_bg)^2+oplcat_2020+mig_by_generation+
having_children_future+years_next_children+desired_nr_add_children+employment_status+
(civil_status + aantalki)+urban_type2+long_disease+anxiety+(partner_2020+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc, hyperparameters = list(tau2=c(1,0.0005)))
model2 <- spikeSlabGAM(new_child ~(religious_participation)+partner_2020+ (gender_bg+birthyear_bg)^2+oplcat_2020+employment_status+
#having_children_future+years_next_children+desired_nr_add_children+
(civil_status + aantalki)+long_disease+anxiety+(urban_type2+type_dwelling)+rely,
data = model_est, family = "binomial", mcmc = mcmc, hyperparameters = list(tau2=c(1,0.0005)))
plot(model2$samples$beta)
summary(model2)
plot(model2)
class <- model_est$new_child
score <- model2$fitted[,2]
# -------------------------------------------------------------
measure <- measureit(score = score, class = class,
measure = c("ACC", "SENS", "FSCR"))
names(measure)
#> [1] "Cutoff" "Depth"  "TP"     "FP"     "TN"     "FN"     "ACC"    "SENS"
#> [9] "FSCR"
plot(measure$ACC~measure$Cutoff, type = "l")
measure$Cutoff[which.max(measure$ACC)]
max(measure$ACC)
